<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.3 $ -->
  <sect1 id="install.netscape-enterprise">
   <title>Servers: Netscape, iPlanet and SunONE</title>
   <para>
    This section contains notes and hints specific to Netscape, iPlanet and SunONE webserver
    installs of PHP, both for <link linkend="install.netscape.sun">Sun Solaris</link>
    and <link linkend="install.netscape.windows">Windows</link> versions.
   </para>
   <para>
    You can find more information about setting up PHP for the Netscape
    Enterprise Server (NES) here:
    <ulink url="&url.netscape.nsapi;">&url.netscape.nsapi;</ulink>
   </para>
   <sect2 id="install.netscape.sun">
    <title>Installing PHP with Netscape on Sun Solaris</title>
    <para>
     To build PHP with NES/iPlanet/SunONE webservers, enter the proper install
     directory for the
     <link linkend="install.configure.with-nsapi">--with-nsapi=[DIR]</link>
     option. The default directory is usually
     <filename class="directory">/opt/netscape/suitespot/</filename>.
     Please also read <filename>/php-xxx-version/sapi/nsapi/nsapi-readme.txt</filename>.
    </para>
    <note>
     <simpara>
      These instructions are written for Sun Solaris 2.6 with Netscape
      Enterprise Server 3.6, conributed by bhager at invacare dot com.
     </simpara>
    </note>
    <para>
     <orderedlist>
      <listitem>
       <para>
        Install the following packages from <ulink url="&url.sun.freeware;">
        &url.sun.freeware;</ulink> or another download site:
        <simplelist>
         <member><filename>autoconf-2.13</filename></member>
         <member><filename>automake-1.4</filename></member>
         <member><filename>bison-1_25-sol26-sparc-local</filename></member>
         <member><filename>flex-2_5_4a-sol26-sparc-local</filename></member>
         <member><filename>gcc-2_95_2-sol26-sparc-local</filename></member>
         <member><filename>gzip-1.2.4-sol26-sparc-local</filename></member>
         <member><filename>m4-1_4-sol26-sparc-local</filename></member>
         <member><filename>make-3_76_1-sol26-sparc-local</filename></member>
         <member>
          <filename>mysql-3.23.24-beta</filename> (if you want mysql support)
         </member>
         <member><filename>perl-5_005_03-sol26-sparc-local</filename></member>
         <member><filename>tar-1.13</filename> (GNU tar)</member>
        </simplelist>
       </para>
      </listitem>
      <listitem>
       <simpara>
        Make sure your path includes the proper directories
        <literal>PATH=.:/usr/local/bin:/usr/sbin:/usr/bin:/usr/ccs/bin</literal>
        and make it available to your system <userinput>export PATH</userinput>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        <userinput>gunzip php-x.x.x.tar.gz</userinput> (if you have a .gz dist,
        otherwise go to 4).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        <userinput>tar xvf php-x.x.x.tar</userinput>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Change to your extracted PHP directory:
        <userinput>cd ../php-x.x.x </userinput>
       </simpara>
      </listitem>
      <listitem>
       <para>
        For the following step, make sure
        <filename class="directory">/opt/netscape/suitespot/</filename> is
        where your netscape server is installed. Otherwise, change to the
        correct path and run:
        <programlisting role="shell">
<![CDATA[
./configure --with-mysql=/usr/local/mysql \
--with-nsapi=/opt/netscape/suitespot/ \
--enable-libgcc
]]>
        </programlisting>
       </para>
      </listitem>
      <listitem>
       <simpara>
        Run <command>make</command> followed by <command>make install</command>.
       </simpara>
      </listitem>
     </orderedlist>
    </para>
    <para>
     After performing the base install and reading the appropriate readme file,
     you may need to perform some additional configuration steps.
    </para>
    <formalpara>
     <title>Configuration Instructions for NES</title>
     <para>
      Firstly you may need to add some paths to the LD_LIBRARY_PATH environment
      for Netscape to find all the shared libs. This can best done in the start
      script for your Netscape server. Windows users can probably skip this
      step. The start script is often located in: <filename
      class="directory">/path/to/server/https-servername/start</filename>.
      You may also need to edit the configuration files that are
      located in: <filename
      class="directory">/path/to/server/https-servername/config/</filename>.
      <orderedlist>
       <listitem>
        <para>
         Add the following line to <filename>mime.types</filename>:
         <screen>
<![CDATA[
type=magnus-internal/x-httpd-php exts=php
]]>
         </screen>
        </para>
       </listitem>
       <listitem>
        <para>
         Edit <filename>obj.conf</filename> and add the following, shlib will
         vary depending on your OS, for Unix it will be something like
         <filename>/opt/netscape/suitespot/bin/libphp4.so</filename>. You should
         place the following lines after <literal>mime types init</literal>.
         <programlisting>
<![CDATA[
Init fn="load-modules" funcs="php4_init,php4_execute,php4_auth_trans" shlib="/opt/netscape/suitespot/bin/libphp4.so"
Init fn=php4_init errorString="Failed to initialize PHP!" [php_ini="/path/to/php.ini"]
]]>
         </programlisting>
         The <literal>php_ini</literal> parameter is optional but with it you can place your
         &php.ini; in your webserver config directory.
        </para>
       </listitem>
       <listitem>
        <para>
         Configure the default object:
         <programlisting>
<![CDATA[
<object name="default">
.
.
.
.#NOTE this next line should happen after all 'ObjectType' and before all 'AddLog' lines
Service fn="php4_execute" type="magnus-internal/x-httpd-php" [inikey=value inikey=value ...]
    .
    .
    </Object>
]]>
         </programlisting>
         As additional parameters you can add some special &php.ini;-values, for example you
         can set a <literal>docroot</literal> specific to the context <literal>php4_execute</literal>
         is called.
        </para>
       </listitem>
       <listitem>
        <para>
         Create a new object for the usage of PHP:
         <programlisting>
<![CDATA[
<Object name="x-httpd-php">
ObjectType fn="force-type" type="magnus-internal/x-httpd-php"
Service fn=php4_execute [inikey=value inikey=value ...]
</Object>
]]>
         </programlisting>
        </para>
       </listitem>
       <listitem>
        <para>
         Setup of authentication: PHP authentication cannot be used with any
         other authentication. ALL AUTHENTICATION IS PASSED TO YOUR PHP SCRIPT.
         To configure PHP Authentication for the entire server, add the
         following line to your default object:
         <programlisting>
<![CDATA[
<Object name="default">
AuthTrans fn=php4_auth_trans
.
.
.
</Object>
]]>
         </programlisting>
        </para>
       </listitem>
       <listitem>
        <para>
         To use PHP Authentication on a single directory, add the following:
         <programlisting>
<![CDATA[
<Object ppath="d:\path\to\authenticated\dir\*">
AuthTrans fn=php4_auth_trans
</Object>
]]>
         </programlisting>
        </para>
       </listitem>
      </orderedlist>
     </para>
    </formalpara>
    <para>
     If you are running Netscape Enterprise 4.x, then you should use the
     following: Place these lines after the <literal>mime types init</literal>,
     and everything else is similar to the example configuration above.
     (Contributed by Graeme Hoose, GraemeHoose at BrightStation dot com).
     <programlisting>
<![CDATA[
Init fn="load-modules" shlib="/path/to/server4/bin/libphp4.so" funcs="php4_init,php4_execute,php4_auth_trans"
Init fn="php4_init" LateInit="yes" [php_ini="/path/to/php.ini"]
]]>
     </programlisting>
    </para>
   </sect2>
   <sect2 id="install.netscape.windows">
    <title>Installing PHP with Netscape on Windows</title>
    <para>
      To Install PHP as CGI (for Netscape Enterprise Server,
      iPlanet, SunONE, perhaps Fastrack), do the following:
    </para>
    <itemizedlist>
     <listitem>
      <simpara>
       Copy <filename>php4ts.dll</filename> to your systemroot
       (the directory where you installed Windows)
      </simpara>
     </listitem>
     <listitem>
      <para>
       Make a file association from the command line.
       Type the following two lines:
       <programlisting role="shell">
<![CDATA[
assoc .php=PHPScript
ftype PHPScript=c:\php\php.exe %1 %*
]]>
       </programlisting>
      </para>
     </listitem>
     <listitem>
      <simpara>
       In the Netscape Enterprise Administration Server create
       a dummy shellcgi directory and remove it just after (this
       step creates 5 important lines in obj.conf and allow the
       web server to handle shellcgi scripts).
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       In the Netscape Enterprise Administration Server create
       a new mime type (Category: type,
       Content-Type: magnus-internal/shellcgi, File Suffix:php).
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Do it for each web server instance you want php to run
      </simpara>
     </listitem>
    </itemizedlist>
    <para>
     More details about setting up
     PHP as a CGI executable can be found here:
     <ulink url="&url.netscape.cgi;">&url.netscape.cgi;</ulink>
    </para>
    <para>
     To Install PHP as NSAPI (for Netscape Enterprise Server,
     iPlanet, SunONE, perhaps Fastrack, do the following:
    </para>
    <itemizedlist>
     <listitem>
      <simpara>
       Copy <filename>php4ts.dll</filename> to your systemroot
       (the directory where you installed Windows)
      </simpara>
     </listitem>
     <listitem>
      <para>
       Make a file association from the command line.
       Type the following two lines:
       <programlisting role="shell">
<![CDATA[
assoc .php=PHPScript
ftype PHPScript=c:\php\php.exe %1 %*
]]>
       </programlisting>
      </para>
     </listitem>
     <listitem>
      <simpara>
       In the Netscape Enterprise Administration Server create
       a new mime type (Category: type,
       Content-Type: magnus-internal/x-httpd-php, File Suffix:php).
      </simpara>
     </listitem>
     <listitem>
      <para>
       Stop your web service and edit <filename>obj.conf</filename>.
       At the end of the Init section, place these two lines
       (necessarily after mime type init!):
       <programlisting>
<![CDATA[
Init fn="load-modules" funcs="php4_init,php4_execute,php4_auth_trans" shlib="c:/php/sapi/php4nsapi.dll"
Init fn="php4_init" errorString="Failed to initialise PHP!" [php_ini="c:/path/to/php.ini"]
]]>
       </programlisting>
       The <literal>php_ini</literal> parameter is optional but with it you can place your
       &php.ini; in your webserver config directory.
      </para>
     </listitem>
     <listitem>
      <para>
       In The <literal>&lt; Object name="default" &gt;</literal>
       section, place this line necessarily after all 'ObjectType'
       and before all 'AddLog' lines:
       <programlisting>
<![CDATA[
Service fn="php4_execute" type="magnus-internal/x-httpd-php" [inikey=value inikey=value ...]
]]>
       </programlisting>
       As additional parameters you can add some special &php.ini;-values, for example you
       can set a <literal>docroot</literal> specific to the context <literal>php4_execute</literal>
       is called.
      </para>
     </listitem>
     <listitem>
      <para>
       At the end of the file, create a new object called
       <literal>x-httpd-php</literal>, by inserting these lines:
       <programlisting>
<![CDATA[
<Object name="x-httpd-php">
ObjectType fn="force-type" type="magnus-internal/x-httpd-php"
Service fn=php4_execute [inikey=value inikey=value ...]
</Object>
]]>
       </programlisting>
      </para>
     </listitem>
     <listitem>
      <simpara>
       Restart your web service and apply changes
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Do it for each web server instance you want PHP to run
      </simpara>
     </listitem>
    </itemizedlist>
    <para>
     More details about setting up
     PHP as an NSAPI filter can be found here:
     <ulink url="&url.netscape.nsapi;">&url.netscape.nsapi;</ulink>
    </para>
   </sect2>
  </sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
