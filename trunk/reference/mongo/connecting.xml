<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->

<section xml:id="mongo.connecting" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Connecting</title>

 <para>
  Connecting to MongoDB can be as easy as <literal>new Mongo</literal>, but 
  there are many additional options and configurations. The 
  <function>Mongo::__construct</function> page covers all of the API options,
  but this page gives some more practical use cases.
 </para>

 <section>
  <title>Logging In on Connection</title>
  <para>
   If MongoDB is started with the <literal>--auth</literal> option, connections
   must be authenticated before they are used.  You can do this on a 
   per-database level with <function>MongoDB::authenticate</function>:
  </para>
  <programlisting role="php">
<![CDATA[
<?php

$m = new Mongo();
$db = $m->admin;

$db->authenticate($username, $password);

?>
]]>
  </programlisting>
  <para>
   There is a major disadvantage to this method: if the database connection is
   dropped and then autoreconnects, the connection will no longer be 
   authenticated.
  </para>
  <para>
   If you use the connection string format described by 
   <function>Mongo::__construct</function>, the database will authenticate the
   connection as soon as it connects and reauthenticate if the connection is 
   re-esetablished.
  </para>
  <para>
   This is equivalent to the code above, except that reconnections to the 
   database will automatically be authenticated:
  </para>
  <programlisting role="php">
<![CDATA[
<?php

$m = new Mongo("mongodb://${username}:${password}@localhost");

?>
]]>
  </programlisting>
  <para>
   By default, the driver will authenticate the user against the admin database.
   To authenticate with a different database, specify the database name after 
   the hosts.  This example will log the user into the "blog" database:
  </para>
  <programlisting role="php">
<![CDATA[
<?php

$m = new Mongo("mongodb://${username}:${password}@localhost/blog");

?>
]]>
  </programlisting>
 </section>

</section>
