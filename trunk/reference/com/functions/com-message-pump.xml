<?xml version='1.0' encoding='iso-8859-1'?>
<!-- $Revision: 1.3 $ -->
<!-- Generated by xml_proto.php v2.0. Found in /scripts directory of phpdoc. -->
<refentry xml:id="function.com-message-pump" xmlns="http://docbook.org/ns/docbook">
 <refnamediv>
  <refname>com_message_pump</refname>
  <refpurpose>Process COM messages, sleeping for up to timeoutms milliseconds</refpurpose>
 </refnamediv>
 <refsect1>
  <title>Description</title>
  <methodsynopsis>
   <type>bool</type><methodname>com_message_pump</methodname>
   <methodparam choice="opt"><type>int</type><parameter>timeoutms</parameter></methodparam>
  </methodsynopsis>

  <para>
   This function will sleep for up to <parameter>timeoutms</parameter>
   milliseconds, or until a message arrives in the queue.  If a message or
   messages arrives before the timeout, they will be dispatched, and the
   function will return &true;.  If the timeout occurs and no messages were
   processed, the return value will be &false;.  If you do not specify a
   value for <parameter>timeoutms</parameter>, then 0 will be assumed.  A 0
   value means that no waiting will be performed; if there are messages
   pending they will be dispatched as before; if there are no messages
   pending, the function will return &false; immediately without sleeping.
  </para>

  <para>
   The purpose of this function is to route COM calls between apartments and
   handle various synchronization issues.  This allows your script to wait
   efficiently for events to be triggered, while still handling other events
   or running other code in the background.  You should use it in a loop, as
   demonstrated by the example in the <function>com_event_sink</function>
   function, until you are finished using event bound COM objects.
  </para>

 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
